<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Météo MIUI - Humidité</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=MiSans:wght@200;300;400;500;600&display=swap">
  <style>
    /* Reset global */
    *, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }
    html, body { width:100%; height:100%; overflow:hidden; font-family:'MiSans',sans-serif; background:#000; color:#fff; }
    #app { position:relative; width:100%; height:100%; overflow:hidden; touch-action:pan-y; }
    .screen {
      position:absolute;
      top:0;
      left:0;
      width:100%;
      height:100%;
      transition:transform .4s ease;
      /* Position par défaut hors-écran à droite */
      transform: translateX(100%);
    }
    .bg, .overlay { position:absolute; top:0; left:0; width:100%; height:100%; }
    .bg { background:linear-gradient(to bottom, #4facfe,#00f2fe); transition:background 1s ease; z-index:0; }
    .overlay { background:rgba(0,0,0,.2); backdrop-filter:blur(24px); z-index:1; }
    .header { position:absolute; top:calc(env(safe-area-inset-top)+16px); width:100%; text-align:center; z-index:2; }
    .header .title { font-size:18px; font-weight:600; }
    .main { position:absolute; top:30%; width:100%; text-align:center; z-index:2; user-select:none; }
    .big { font-size:120px; font-weight:200; line-height:1; animation:fadeIn 1s ease; }
    .sub { font-size:24px; font-weight:300; opacity:.9; margin-top:-12px; animation:fadeIn 1.2s ease; }
    @keyframes fadeIn { from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);} }
    .tab-bar { position:absolute; bottom:0; left:0; width:100%; display:flex; background:rgba(0,0,0,.25); backdrop-filter:blur(16px); z-index:2; }
    .tab { flex:1; text-align:center; padding:12px 0; font-size:14px; font-weight:500; cursor:pointer; user-select:none; position:relative; }
    .tab.active { color:#4facfe; }
    .tab.active::after { content:''; position:absolute; bottom:4px; left:30%; width:40%; height:2px; background:#4facfe; border-radius:1px; }
  </style>
</head>
<body>
  <div id="app">
    <!-- Screen 0: Weather -->
    <section id="home" class="screen" style="transform: translateX(0%)">
      <div class="bg" id="bgHome"></div>
      <div class="overlay"></div>
      <div class="header"><div class="title" id="loc">Ville</div></div>
      <div class="main">
        <div class="big" id="temp">--°C</div>
        <div class="sub" id="desc">---</div>
      </div>
      <nav class="tab-bar">
        <div class="tab active" data-screen="home">Météo</div>
        <div class="tab" data-screen="humid">Humidité</div>
      </nav>
    </section>
    <!-- Screen 1: Humidity -->
    <section id="humid" class="screen">
      <div class="bg" id="bgHumid"></div>
      <div class="overlay"></div>
      <div class="header"><div class="title">Humidité</div></div>
      <div class="main">
        <div class="big" id="humidityVal">--%</div>
      </div>
      <nav class="tab-bar">
        <div class="tab" data-screen="home">Météo</div>
        <div class="tab active" data-screen="humid">Humidité</div>
      </nav>
    </section>
  </div>
  <div id="searchBar" style="position:absolute;top:16px;right:16px;z-index:3;">
    <input id="cityInput" type="text" placeholder="Ville..." style="padding:6px;border-radius:8px;" />
    <button id="searchBtn" style="padding:6px;border-radius:8px;background:rgba(255,255,255,.3);">OK</button>
  </div>
  <script>
    // Navigation
    let startX=0, current=0;
    const tabs=document.querySelectorAll('.tab');
    const screens=document.querySelectorAll('.screen');
    function show(idx) {
      screens.forEach((s,i)=>{
        s.style.transform=`translateX(${(i-idx)*100}%)`;
        s.style.zIndex=i===idx?3:1;
      });
      tabs.forEach((t,i)=>t.classList.toggle('active',i===idx));
      current=idx;
    }
    tabs.forEach((t,i)=>t.addEventListener('click',()=>show(i)));
    const appEl=document.getElementById('app');
    appEl.addEventListener('touchstart',e=>startX=e.touches[0].clientX);
    appEl.addEventListener('touchend',e=>{
      const dx=e.changedTouches[0].clientX-startX;
      if(dx>50 && current>0) show(current-1);
      else if(dx<-50 && current<1) show(current+1);
    });
    // Fetch weather
    const API='f570ba4a8945e02cc0cdf9bb166d14e1';
    async function load(city) {
      if(!city) return;
      try{
        const wRes=await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(city)}&units=metric&appid=${API}&lang=fr`);
        const w=await wRes.json();
        document.getElementById('loc').textContent=w.name;
        document.getElementById('temp').textContent=Math.round(w.main.temp)+'°C';
        document.getElementById('desc').textContent=w.weather[0].description;
        document.getElementById('humidityVal').textContent=w.main.humidity+'%';
        const map={Clear:['#4facfe','#00f2fe'],Clouds:['#757f9a','#d7dde8'],Rain:['#4B79A1','#283E51'],Snow:['#83a4d4','#b6fbff'],Mist:['#606c88','#3f4c6b']};
        const c=w.weather[0].main;
        ['bgHome','bgHumid'].forEach(id=>{
          const el=document.getElementById(id);
          const gr=map[c]||map.Clear;
          el.style.background=`linear-gradient(to bottom, ${gr[0]}, ${gr[1]})`;
        });
      }catch(e){console.error(e)}
    }
    document.getElementById('searchBtn').addEventListener('click',()=>load(document.getElementById('cityInput').value));
    document.getElementById('cityInput').addEventListener('keydown',e=>e.key==='Enter'&&load(e.target.value));
    // Initial
    show(0);
    load('Paris');
  </script>
</body>
</html>
